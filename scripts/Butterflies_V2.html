<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.433">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Butterflies</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="Butterflies_V2_files/libs/clipboard/clipboard.min.js"></script>
<script src="Butterflies_V2_files/libs/quarto-html/quarto.js"></script>
<script src="Butterflies_V2_files/libs/quarto-html/popper.min.js"></script>
<script src="Butterflies_V2_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="Butterflies_V2_files/libs/quarto-html/anchor.min.js"></script>
<link href="Butterflies_V2_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="Butterflies_V2_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="Butterflies_V2_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="Butterflies_V2_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="Butterflies_V2_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">


</head>

<body class="fullcontent">

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">

<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Butterflies</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header>

<section id="study-overview" class="level2">
<h2 class="anchored" data-anchor-id="study-overview">Study overview</h2>
<p>Our group was interested in analyzing an ecological data set, since we have backgrounds in environmental field work. So for our project, we decided to work with a dataset called <em>Data for butterfly near-infrared adaptation research</em> which we found on <strong>Dryad</strong>. We decided on this dataset because it seemed to have many climate variables that could lead to model comparisons with different combinations of predictors.&nbsp;</p>
<p>The dataset was collected by Kang et al.&nbsp;(Kang, Changku; Lim, Sehyuk; Lee, Won Young; Choi, Yunki; Stuart-fox, Devi; Huertas, Blanca).</p>
<p>This dataset was collected with the goal of determining whether butterfly light reflectance is impacted by climate variables. To accomplish this, the researchers photographed 343 European butterfly species from the Natural History Museum of London and measured both Visible (VIS) and Near-infrared (NIR) reflectance of different body regions.</p>
<p>When possible, they photographed two of each species and averaged the reflectance values, for a sample size of 684 specimens overall. This sample size could skew our results because it did not account for a lot of intraspecific variation, and took 1-2 butterflies to be representative of an entire climatic niche. On a positive note, the 343 species photographed was a large sample size for focusing on interspecific variation, since this covered 70% of all butterfly species in Europe.</p>
<div class="cell">
<div class="cell-output cell-output-stderr">
<pre><code>── Attaching core tidyverse packages ──────────────────────── tidyverse 2.0.0 ──
✔ dplyr     1.1.4     ✔ readr     2.1.5
✔ forcats   1.0.0     ✔ stringr   1.5.1
✔ ggplot2   3.5.2     ✔ tibble    3.2.1
✔ lubridate 1.9.4     ✔ tidyr     1.3.1
✔ purrr     1.0.4     
── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──
✖ dplyr::filter() masks stats::filter()
✖ dplyr::lag()    masks stats::lag()
ℹ Use the conflicted package (&lt;http://conflicted.r-lib.org/&gt;) to force all conflicts to become errors</code></pre>
</div>
</div>
</section>
<section id="data-overview" class="level2">
<h2 class="anchored" data-anchor-id="data-overview">Data overview</h2>
<p>Let’s take a quick look at the dataset! Each of the rows is a species of butterfly, and then there are several predictor variables and response variables that the researchers looked at.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co"># loading in the dataset</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>dat <span class="ot">=</span> readxl<span class="sc">::</span><span class="fu">read_xlsx</span>(<span class="st">"../files/ButterflyNIRData.xlsx"</span>)</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(dat)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 23
  Species           temp.mean temp.min temp.max precip.mean SolarRadi WaterVapor
  &lt;chr&gt;                 &lt;dbl&gt;    &lt;dbl&gt;    &lt;dbl&gt;       &lt;dbl&gt;     &lt;dbl&gt;      &lt;dbl&gt;
1 Iphiclides podal…     10.9      0.85     18.4        780.    13784.      0.988
2 Papilio alexanor      12.6      3.25     16.6        881.    15899.      0.953
3 Papilio hospiton      14.7     12.3      16.4        684     15457.      1.26 
4 Papilio machaon        9.28    -3.1      18.6        737.    12363.      0.942
5 Parnassius mnemo…      8.79    -0.91     16.8        804.    12810.      0.866
6 Parnassius apollo      8.14    -0.97     17.5        850.    13106.      0.843
# ℹ 16 more variables: Isothermality &lt;dbl&gt;, PrecipSeasonality &lt;dbl&gt;,
#   TempSeasonality &lt;dbl&gt;, Size &lt;dbl&gt;, VisDorsB &lt;dbl&gt;, VisDorsE &lt;dbl&gt;,
#   VisDorsT &lt;dbl&gt;, VisVentB &lt;dbl&gt;, VisVentE &lt;dbl&gt;, VisVentT &lt;dbl&gt;,
#   NirDorsB &lt;dbl&gt;, NirDorsE &lt;dbl&gt;, NirDorsT &lt;dbl&gt;, NirVentB &lt;dbl&gt;,
#   NirVentE &lt;dbl&gt;, NirVentT &lt;dbl&gt;</code></pre>
</div>
</div>
<p>We also created a column that extracted the genus of each species. Here’s some of the data we have on each butterfly species.</p>
<p>We have the species and genus of each butterfly, which are <em>character</em> data, and the size of the entire wing was measured as an additional variable to consider, and was averaged within a species.</p>
<table class="table">
<colgroup>
<col style="width: 37%">
<col style="width: 62%">
</colgroup>
<thead>
<tr class="header">
<th>Variable</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Species</td>
<td>species name</td>
</tr>
<tr class="even">
<td>Size</td>
<td>size (cm2) measured from one side of the both fore-/hind-wings</td>
</tr>
<tr class="odd">
<td>Genus</td>
<td>genus of species</td>
</tr>
</tbody>
</table>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="co"># genus dat obtained like so: </span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>dat <span class="ot">=</span> dat <span class="sc">%&gt;%</span> </span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">genus =</span> <span class="fu">str_match</span>(<span class="fu">gsub</span>(<span class="st">"_"</span>, <span class="st">" "</span>, dat<span class="sc">$</span>Species), <span class="st">"([A-Z,a-z]*) "</span>)[,<span class="dv">2</span>]) <span class="sc">%&gt;%</span> </span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.data.frame</span>()</span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a><span class="co"># data about the butterfly</span></span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(dat)[,<span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">11</span>, <span class="dv">24</span>)]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                Species     Size      genus
1 Iphiclides podalirius 20.25024 Iphiclides
2      Papilio alexanor 17.36228    Papilio
3      Papilio hospiton 13.84361    Papilio
4       Papilio machaon 21.61053    Papilio
5  Parnassius mnemosyne 10.44033 Parnassius
6     Parnassius apollo 24.07698 Parnassius</code></pre>
</div>
</div>
<p>We have a bunch of climactic predictor variables in the dataset as well!</p>
<p>The climate variables were collected from the CLIMBER dataset and WorldClim data, and were averaged across the geographic distribution of each species. The data class for all variables here is <em>numeric</em></p>
<section id="predictor-variables" class="level4">
<h4 class="anchored" data-anchor-id="predictor-variables">Predictor variables</h4>
<table class="table">
<colgroup>
<col style="width: 37%">
<col style="width: 62%">
</colgroup>
<thead>
<tr class="header">
<th>Variable</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>temp.mean</td>
<td>mean annual temperature (°C) across a species’ range</td>
</tr>
<tr class="even">
<td>temp.min</td>
<td>mimimum annual temperature (°C) across a species’ range</td>
</tr>
<tr class="odd">
<td>temp.max</td>
<td>maximum annual temperature (°C) across a species’ range</td>
</tr>
<tr class="even">
<td>precip.mean</td>
<td>mean of annual precipitation sum (mm) across a species’ range</td>
</tr>
<tr class="odd">
<td>SolarRadi</td>
<td>mean solar irradiation (kJ m-2 day-1) across a species’ range</td>
</tr>
<tr class="even">
<td>WaterVapor</td>
<td>water vapour pressure (kPa)</td>
</tr>
<tr class="odd">
<td>Isothermality</td>
<td>isothermality</td>
</tr>
<tr class="even">
<td>PrecipSeasonality</td>
<td>precipitation seasonality</td>
</tr>
<tr class="odd">
<td>TempSeasonality</td>
<td>temperature seasonality</td>
</tr>
</tbody>
</table>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="co"># predictor var = different climactic measurements</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(dat)[,<span class="fu">c</span>(<span class="dv">3</span><span class="sc">:</span><span class="dv">11</span>)]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  temp.min temp.max precip.mean SolarRadi WaterVapor Isothermality
1     0.85    18.41      780.33  13783.91  0.9880170      36.20538
2     3.25    16.60      880.79  15899.38  0.9527519      52.68902
3    12.27    16.41      684.00  15456.77  1.2623871      50.77001
4    -3.10    18.64      737.43  12362.51  0.9421449      33.92733
5    -0.91    16.84      803.60  12809.61  0.8657267      32.92128
6    -0.97    17.49      850.09  13106.35  0.8430903      28.49262
  PrecipSeasonality TempSeasonality     Size
1          34.10408        686.3386 20.25024
2          34.10217        734.4379 17.36228
3          33.20617        569.3083 13.84361
4          32.05156        702.6496 21.61053
5          31.22252        757.4306 10.44033
6          33.28837        681.8594 24.07698</code></pre>
</div>
</div>
</section>
<section id="response-variables" class="level4">
<h4 class="anchored" data-anchor-id="response-variables">Response variables</h4>
<p>Then, you’ll see below that each response column is a combination of 3 separate parts.</p>
<table class="table">
<thead>
<tr class="header">
<th>Variable</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>B</td>
<td>basal wing</td>
</tr>
<tr class="even">
<td>E</td>
<td>entire wings</td>
</tr>
<tr class="odd">
<td>T</td>
<td>abdomen-thorax region</td>
</tr>
<tr class="even">
<td>Dors</td>
<td>dorsal wings</td>
</tr>
<tr class="odd">
<td>Vent</td>
<td>ventral wings</td>
</tr>
</tbody>
</table>
<p><img src="images/butterfly_loc.png" class="img-fluid"></p>
<table class="table">
<thead>
<tr class="header">
<th>Variable</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Vis</td>
<td>the mean reflectance in the visible range (UV+VIS)</td>
</tr>
<tr class="even">
<td>Nir</td>
<td>the mean reflectance in the near-infared range</td>
</tr>
</tbody>
</table>
<div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="co"># response var set 1 = vis</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(dat)[,<span class="dv">12</span><span class="sc">:</span><span class="dv">17</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   VisDorsB VisDorsE  VisDorsT VisVentB VisVentE VisVentT
1 25.866747 43.67681 14.628524 44.44800 48.97116 32.87117
2  7.824710 32.69461 13.130427 30.74939 40.00370 19.78546
3  9.126394 23.89890  6.544402 25.62982 34.58003 25.94533
4  5.847905 20.16035  3.286720 15.65930 27.78415 11.91858
5 19.842268 58.81250  7.837889 30.79501 66.42370 11.08532
6 13.697166 48.74571  8.180123 38.84700 57.96575 22.72925</code></pre>
</div>
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="co"># response var set 2 = nir</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(dat)[,<span class="dv">18</span><span class="sc">:</span><span class="dv">23</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  NirDorsB NirDorsE NirDorsT NirVentB NirVentE NirVentT
1 51.99333 78.16716 37.66000 89.09441 85.56392 67.80520
2 24.71176 69.10069 36.50167 69.59559 79.21245 47.90059
3 29.43353 60.00324 22.82422 63.57627 76.71147 59.11824
4 20.62216 48.73245 12.97647 39.86490 60.33892 29.33667
5 47.60275 90.85922 23.93167 68.97108 95.67892 35.51265
6 37.05157 82.67039 22.88069 78.94529 90.00324 55.30078</code></pre>
</div>
</div>
</section>
</section>
<section id="further-context-for-variables" class="level2">
<h2 class="anchored" data-anchor-id="further-context-for-variables">Further context for variables</h2>
<p>The reflectance of butterfly wings in the <strong>Visual (VIS)</strong> range plays an important role in both <strong>camouflage and thermoregulation</strong>; the color of butterflies helps them to both blend into their surroundings or scare off predators, and to absorb or reflect a certain amount of heat from solar energy. However, 50% of solar energy extends beyond visual wavelengths to the Near-infrared (NIR). In contrast to VIS range reflectance, <strong>NIR</strong> reflectance plays no role in camouflage, suggesting it could play a <strong>more important role in thermoregulation</strong>.</p>
<p>Additionally, certain butterfly body regions are more important for thermoregulation than others. Specifically, the <strong>basal region</strong> of the wings and the <strong>thorax/abdomen</strong> region of the body <strong>conduct heat</strong> to the flight muscles.</p>
<p>Butterflies also regulate their body temperature by opening and closing their wings to expose or hide themselves from sunlight. <strong>Dorsal basking</strong> exposes the top part of their wings to sun, and plays an important role in <strong>warming up</strong>. Butterflies also close their wings tightly to shield themselves from solar radiation and <strong>cool down</strong>, which exposes the bottom, or <strong>ventral</strong> part of their wings.</p>
<p>Below is one graph that explores a potential relationship between a climate variable (temp.mean) and the Visual reflectance of different butterfly body regions. This visualization supports the ecological hypothesis that Dorsal reflectance may be more important for warming while Ventral reflectance may be more important for cooling: you can see that the blue Dorsal regions generally have lower reflectance values since darker colors aid in absorbing heat, while pink Ventral regions have higher reflectance values since this may help butterflies cool off more efficiently by reflecting more sunlight when closing their wings. Additionally, Basal (B) and Thorax-Abdomen (T) regions are more involved in thermoregulation than the rest of the wing. This could be why the dashed lines for Entire wing (E) have lower slopes than the solid line VentralT and VentralB; changes in the climate variable of mean temperature have a stronger impact on the B and T regions, which are important in thermoregulation, than the E region.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>dat <span class="sc">%&gt;%</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="dv">12</span><span class="sc">:</span><span class="dv">23</span>,</span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>               <span class="at">names_pattern =</span> <span class="st">"([A-Z]i[a-z])([A-Z][a-z]*[A-Z])"</span>,</span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>               <span class="at">names_to =</span> <span class="fu">c</span>(<span class="st">".value"</span>, <span class="st">"location"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="at">data =</span> ., <span class="fu">aes</span>(<span class="at">x =</span> temp.mean, <span class="at">y =</span> Vis, <span class="at">color =</span> location)) <span class="sc">+</span></span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.35</span>, <span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="fu">aes</span>(<span class="at">linetype =</span> location), <span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">size =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(</span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">values =</span> <span class="fu">c</span>(<span class="st">"DorsB"</span> <span class="ot">=</span> <span class="st">"blue"</span>,<span class="st">"VentB"</span> <span class="ot">=</span> <span class="st">"magenta3"</span>,</span>
<span id="cb12-10"><a href="#cb12-10" aria-hidden="true" tabindex="-1"></a>               <span class="st">"DorsT"</span> <span class="ot">=</span> <span class="st">"steelblue1"</span>,<span class="st">"VentT"</span> <span class="ot">=</span> <span class="st">"maroon4"</span>,</span>
<span id="cb12-11"><a href="#cb12-11" aria-hidden="true" tabindex="-1"></a>               <span class="st">"DorsE"</span> <span class="ot">=</span> <span class="st">"royalblue1"</span>,<span class="st">"VentE"</span> <span class="ot">=</span> <span class="st">"hotpink2"</span>)) <span class="sc">+</span></span>
<span id="cb12-12"><a href="#cb12-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_linetype_manual</span>(</span>
<span id="cb12-13"><a href="#cb12-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">values =</span> <span class="fu">c</span>(<span class="st">"DorsB"</span> <span class="ot">=</span> <span class="st">"solid"</span>, <span class="st">"DorsT"</span> <span class="ot">=</span> <span class="st">"solid"</span>,</span>
<span id="cb12-14"><a href="#cb12-14" aria-hidden="true" tabindex="-1"></a>               <span class="st">"DorsE"</span> <span class="ot">=</span> <span class="st">"dashed"</span>, <span class="st">"VentB"</span> <span class="ot">=</span> <span class="st">"solid"</span>,</span>
<span id="cb12-15"><a href="#cb12-15" aria-hidden="true" tabindex="-1"></a>               <span class="st">"VentT"</span> <span class="ot">=</span> <span class="st">"solid"</span>, <span class="st">"VentE"</span> <span class="ot">=</span> <span class="st">"dashed"</span>)) <span class="sc">+</span></span>
<span id="cb12-16"><a href="#cb12-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.key.width =</span> <span class="fu">unit</span>(<span class="dv">2</span>, <span class="st">"cm"</span>)) <span class="sc">+</span></span>
<span id="cb12-17"><a href="#cb12-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Mean Temperature (C)"</span>, <span class="at">y =</span> <span class="st">"VIS Reflectance"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using formula = 'y ~ x'</code></pre>
</div>
<div class="cell-output-display">
<p><img src="Butterflies_V2_files/figure-html/intro%20graph-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>This visualization provided evidence that made us want to test for more differences in body region reflectance and the impact that different climate variables have on this variation. For simplicity, we decided to focus on the body regions of Basal wing, Thorax, and Entire wing as our predictors of reflectance variation, rather than splitting these into Ventral and Dorsal as well. We hoped that we would still get significant results, since we hypothesized that Basal and Thorax regions would respond more strongly to climate variables than the Entire wing since they are more important in thermoregulation.</p>
<section id="hypothesis" class="level4">
<h4 class="anchored" data-anchor-id="hypothesis">Hypothesis</h4>
<p>Therefore, <strong>different climatic pressures could cause variation in reflectance values for different butterfly body regions</strong>, or in other words, we think the BET (basal, entire, abdomen / thorax) regions might reflect light differently depending on the typical climactic conditions that each species might be exposed to.</p>
<p><strong>So then, how do the different body regions (B, E, and T) respond to different climate conditions and do they do so differently from one another?</strong></p>
</section>
</section>
<section id="data-manipulation" class="level2">
<h2 class="anchored" data-anchor-id="data-manipulation">Data manipulation</h2>
<p>To prepare the data for analysis, we <strong>added a column for butterfly genus</strong> by isolating the first word of the “Species” column variables. This <strong>allowed us to include genus as a random effect variable</strong> in our model to account for variation that may result from genetic relationships. (we did this earlier :))</p>
<p>Additionally, our data currently groups together the dorsal and ventral sides with basal, entire, and abdomen / thorax (BET). However, we wanted to look only at the interaction between BET with the climactic variables, so we needed to separate out the dorsal and ventral into its own column, and BET into its own columns.</p>
<p>To do this, we used the <strong>pivot_longer</strong> function to alter the columns so that instead of having twelve different response variable columns for NIR / VIS reflectance for Dorsal / Ventral side for the B / T / E body regions (ex: VisDorsT), we had one reflectance column for NIR, one reflectance column for VIS, one column denoting whether the body region was Dorsal or Ventral, and one column denoting whether the body region was B, T, or E. This <strong>allowed us to generate a model where the body region type (B, E, or T) could be used as a predictor variable for NIR and VIS reflectance</strong>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="co"># separating out dorsal / ventral and B / E / T</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>longdat <span class="ot">=</span> dat <span class="sc">%&gt;%</span></span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="dv">12</span><span class="sc">:</span><span class="dv">23</span>,</span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>               <span class="at">names_pattern =</span> <span class="st">"([A-Z]i[a-z])([A-Z][a-z]*)([A-Z])"</span>,</span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a>               <span class="at">names_to =</span> <span class="fu">c</span>(<span class="st">".value"</span>, <span class="st">"dorvent"</span>, <span class="st">"BET"</span>))</span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a>longdat[,<span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">13</span><span class="sc">:</span><span class="dv">16</span>)] <span class="sc">%&gt;%</span> <span class="fu">head</span>(<span class="dv">5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 5 × 5
  Species               dorvent BET     Vis   Nir
  &lt;chr&gt;                 &lt;chr&gt;   &lt;chr&gt; &lt;dbl&gt; &lt;dbl&gt;
1 Iphiclides podalirius Dors    B      25.9  52.0
2 Iphiclides podalirius Dors    E      43.7  78.2
3 Iphiclides podalirius Dors    T      14.6  37.7
4 Iphiclides podalirius Vent    B      44.4  89.1
5 Iphiclides podalirius Vent    E      49.0  85.6</code></pre>
</div>
</div>
<p><strong>So now let’s run the model!</strong> Our two response variables will be Vis and Nir, the reflectance on the UV / visual spectrum, and the infrared spectrum respectively. We’ll be doing indendent models for each of these, so let’s go through vis first.</p>
<p>For our global model (aka our model with what we think is the maximum predictors and interactions that the model should have, we decided to look at 4 predictor variables: solar radiation, mean precipitation, water vapor pressure, and isothermality).</p>
<p>These are climate variables that have large implications for butterfly life and wing reflectance. Temperature mean and isothermality both have to do with temperature regulation. Mean precipitation and water vapor both have to do with moisture regulation, which we hypothesize are connected to wing area and general reflectance. We also expect solar radiation to impact reflectance directly.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>global_mod_vis <span class="ot">=</span> lme4<span class="sc">::</span><span class="fu">lmer</span>(Vis <span class="sc">~</span> BET<span class="sc">*</span>SolarRadi <span class="sc">+</span> BET<span class="sc">*</span>precip.mean <span class="sc">+</span> BET<span class="sc">*</span>WaterVapor <span class="sc">+</span> BET<span class="sc">*</span>Isothermality <span class="sc">+</span> BET<span class="sc">*</span>temp.mean <span class="sc">+</span> (<span class="dv">1</span><span class="sc">|</span>genus) <span class="sc">+</span> (<span class="dv">1</span><span class="sc">|</span>dorvent) <span class="sc">-</span> <span class="dv">1</span>, </span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>             <span class="at">data =</span> longdat, <span class="at">na.action =</span> <span class="st">"na.fail"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Some predictor variables are on very different scales: consider
rescaling</code></pre>
</div>
</div>
<p>When running the model, we immediately ran into a warning that our predictor variables are on different scales, and to accommodate for this, we decided to convert all our values to z-scores so they could be on similar scales.</p>
<p>Since our data is not normally distributed, we did a robust z-score.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>jull_rob.zscore <span class="ot">&lt;-</span> <span class="cf">function</span>(df){</span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>  mad.cols <span class="ot">&lt;-</span> mad.temp <span class="ot">&lt;-</span> med.cols <span class="ot">&lt;-</span> <span class="fu">c</span>()</span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>  z.score <span class="ot">&lt;-</span> <span class="fu">data.frame</span>()</span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(<span class="fu">colnames</span>(df))){</span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span>(j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(df[,i])){</span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a>      mad.temp[j] <span class="ot">&lt;-</span> <span class="fu">abs</span>(<span class="fu">as.numeric</span>(df[j,i]) <span class="sc">-</span> <span class="fu">median</span>((df[,i])))</span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb18-8"><a href="#cb18-8" aria-hidden="true" tabindex="-1"></a>    mad.cols[i] <span class="ot">&lt;-</span> <span class="fu">median</span>((mad.temp))</span>
<span id="cb18-9"><a href="#cb18-9" aria-hidden="true" tabindex="-1"></a>    med.cols[i] <span class="ot">&lt;-</span> <span class="fu">median</span>(<span class="fu">as.numeric</span>(df[,i]))</span>
<span id="cb18-10"><a href="#cb18-10" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb18-11"><a href="#cb18-11" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(<span class="fu">colnames</span>(df))){</span>
<span id="cb18-12"><a href="#cb18-12" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span>(j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(df[,i])){</span>
<span id="cb18-13"><a href="#cb18-13" aria-hidden="true" tabindex="-1"></a>      z.score[j,i] <span class="ot">&lt;-</span> (<span class="fl">0.6745</span><span class="sc">*</span>(df[j,i]<span class="sc">-</span>med.cols[i]))<span class="sc">/</span>mad.cols[i]</span>
<span id="cb18-14"><a href="#cb18-14" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb18-15"><a href="#cb18-15" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb18-16"><a href="#cb18-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">colnames</span>(z.score) <span class="ot">&lt;-</span> <span class="fu">colnames</span>(df)</span>
<span id="cb18-17"><a href="#cb18-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rownames</span>(z.score) <span class="ot">&lt;-</span> <span class="fu">rownames</span>(df)</span>
<span id="cb18-18"><a href="#cb18-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(<span class="at">z.score =</span> z.score)</span>
<span id="cb18-19"><a href="#cb18-19" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb18-20"><a href="#cb18-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-21"><a href="#cb18-21" aria-hidden="true" tabindex="-1"></a>zscore_dat <span class="ot">=</span> <span class="fu">cbind</span>(longdat[<span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">12</span><span class="sc">:</span><span class="dv">16</span>)], <span class="fu">jull_rob.zscore</span>(<span class="fu">as.data.frame</span>(longdat)[<span class="dv">2</span><span class="sc">:</span><span class="dv">11</span>]))</span>
<span id="cb18-22"><a href="#cb18-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-23"><a href="#cb18-23" aria-hidden="true" tabindex="-1"></a>zscore_dat <span class="sc">%&gt;%</span> <span class="fu">head</span>(<span class="dv">5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                Species      genus dorvent BET      Vis      Nir temp.mean
1 Iphiclides podalirius Iphiclides    Dors   B 25.86675 51.99333 0.3786108
2 Iphiclides podalirius Iphiclides    Dors   E 43.67681 78.16716 0.3786108
3 Iphiclides podalirius Iphiclides    Dors   T 14.62852 37.66000 0.3786108
4 Iphiclides podalirius Iphiclides    Vent   B 44.44800 89.09441 0.3786108
5 Iphiclides podalirius Iphiclides    Vent   E 48.97116 85.56392 0.3786108
    temp.min  temp.max precip.mean SolarRadi WaterVapor Isothermality
1 -0.1090681 0.8079572  0.08715387 0.1412039  0.7511881     0.5884298
2 -0.1090681 0.8079572  0.08715387 0.1412039  0.7511881     0.5884298
3 -0.1090681 0.8079572  0.08715387 0.1412039  0.7511881     0.5884298
4 -0.1090681 0.8079572  0.08715387 0.1412039  0.7511881     0.5884298
5 -0.1090681 0.8079572  0.08715387 0.1412039  0.7511881     0.5884298
  PrecipSeasonality TempSeasonality     Size
1         0.6250344      -0.0513445 4.328524
2         0.6250344      -0.0513445 4.328524
3         0.6250344      -0.0513445 4.328524
4         0.6250344      -0.0513445 4.328524
5         0.6250344      -0.0513445 4.328524</code></pre>
</div>
</div>
</section>
<section id="uv-visual-reflectance-model" class="level2">
<h2 class="anchored" data-anchor-id="uv-visual-reflectance-model">UV / Visual reflectance model</h2>
<p>Now that we can actually fit our model, let’s take a look at the aic scores! We’re using a function called <code>dredge()</code> which is from the <code>MuMIn</code> package. This essentially takes a <em>global model</em> that has your maximum predictors and interactions, and then randomly drops them until it finds every combination smaller than the model you have.</p>
<p>So assuming your model looked like this: <code>response ~ pred1 + pred2*pred3</code>, then <code>dredge()</code> can return the AIC scores of the following models:</p>
<ul>
<li><code>response ~ pred1 + pred2*pred3</code></li>
<li><code>response ~ pred1 + pred2 + pred3</code></li>
<li><code>response ~ pred2*pred3</code></li>
<li><code>response ~ pred2 + pred3</code></li>
<li><code>response ~ pred1 + pred2</code></li>
<li><code>response ~ pred1 + pred3</code></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>global_mod_vis <span class="ot">=</span> lme4<span class="sc">::</span><span class="fu">lmer</span>(Vis <span class="sc">~</span> BET<span class="sc">*</span>SolarRadi <span class="sc">+</span> BET<span class="sc">*</span>precip.mean <span class="sc">+</span> BET<span class="sc">*</span>WaterVapor <span class="sc">+</span> BET<span class="sc">*</span>Isothermality <span class="sc">+</span> BET<span class="sc">*</span>temp.mean <span class="sc">+</span> (<span class="dv">1</span><span class="sc">|</span>genus) <span class="sc">+</span> (<span class="dv">1</span><span class="sc">|</span>dorvent) <span class="sc">-</span> <span class="dv">1</span>, </span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>             <span class="at">data =</span> zscore_dat, <span class="at">na.action =</span> <span class="st">"na.fail"</span>)</span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a>aic_score_vis <span class="ot">=</span> MuMIn<span class="sc">::</span><span class="fu">dredge</span>(global_mod_vis, <span class="at">beta =</span> <span class="st">"none"</span>)</span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a>aic_score_vis <span class="sc">%&gt;%</span> <span class="fu">arrange</span>(AICc) <span class="sc">%&gt;%</span> <span class="fu">head</span>(<span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Global model call: lme4::lmer(formula = Vis ~ BET * SolarRadi + BET * precip.mean + 
    BET * WaterVapor + BET * Isothermality + BET * temp.mean + 
    (1 | genus) + (1 | dorvent) - 1, data = zscore_dat, na.action = "na.fail")
---
Model selection table 
  BET    Ist      SlR tmp.men     WtV BET:Ist BET:SlR BET:tmp.men BET:WtV df
1   + 0.1750  0.36710   1.429               +       +           +         15
2   + 0.1539 -0.15910   2.397 -0.6104       +       +           +       + 18
3   + 0.1513  0.02274   2.071 -0.4083       +       +           +         16
     logLik    AICc delta weight
1 -7472.341 14974.9  0.00  0.417
2 -7469.578 14975.5  0.57  0.313
3 -7471.763 14975.8  0.87  0.269
Models ranked by AICc(x) 
Random terms (all models): 
  1 | genus, 1 | dorvent</code></pre>
</div>
</div>
<p>And the model best chosen by our AIC test is this one! We are including solar radiation, isothermality, mean temperature, and all of the interactions between those and BET.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>aic_mod_vis <span class="ot">=</span> zscore_dat <span class="sc">%&gt;%</span> </span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>  lme4<span class="sc">::</span><span class="fu">lmer</span>((Vis) <span class="sc">~</span> BET<span class="sc">*</span>SolarRadi <span class="sc">+</span> BET<span class="sc">*</span>Isothermality <span class="sc">+</span> BET<span class="sc">*</span>temp.mean <span class="sc">+</span> (<span class="dv">1</span><span class="sc">|</span>genus) <span class="sc">+</span> (<span class="dv">1</span><span class="sc">|</span>dorvent) <span class="sc">-</span> <span class="dv">1</span>, </span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a>             <span class="at">data =</span> ., <span class="at">na.action =</span> <span class="st">"na.fail"</span>)</span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a>aic_mod_vis <span class="sc">%&gt;%</span> car<span class="sc">::</span><span class="fu">Anova</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Analysis of Deviance Table (Type II Wald chisquare tests)

Response: (Vis)
                     Chisq Df Pr(&gt;Chisq)    
BET               588.8156  3  &lt; 2.2e-16 ***
SolarRadi           5.8337  1   0.015722 *  
Isothermality       7.2976  1   0.006905 ** 
temp.mean           1.6205  1   0.203026    
BET:SolarRadi       2.6981  2   0.259483    
BET:Isothermality   8.6026  2   0.013551 *  
BET:temp.mean      10.8218  2   0.004468 ** 
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
<p>Using the dredged model (and omitting the unecessary parameters), we were able to test how well the model fit the data using the DHARMa package.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>DHARMa<span class="sc">::</span><span class="fu">testDispersion</span>(DHARMa<span class="sc">::</span><span class="fu">simulateResiduals</span>(aic_mod_vis))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Butterflies_V2_files/figure-html/residuals%20on%20vis%20aic%20mod-1.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
    DHARMa nonparametric dispersion test via sd of residuals fitted vs.
    simulated

data:  simulationOutput
dispersion = 0.96759, p-value = 0.76
alternative hypothesis: two.sided</code></pre>
</div>
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>DHARMa<span class="sc">::</span><span class="fu">simulateResiduals</span>(aic_mod_vis, <span class="at">n =</span> <span class="dv">1000</span>, <span class="at">plot =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Butterflies_V2_files/figure-html/residuals%20on%20vis%20aic%20mod-2.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Object of Class DHARMa with simulated residuals based on 1000 simulations with refit = FALSE . See ?DHARMa::simulateResiduals for help. 
 
Scaled residual values: 0.557 0.718 0.283 0.911 0.858 0.713 0.135 0.363 0.186 0.648 0.598 0.338 0.154 0.265 0.091 0.527 0.507 0.481 0.161 0.247 ...</code></pre>
</div>
</div>
<p>Well clearly, these aren’t the greatest model fits. So from here we wanted to see if there were any models we could fit with different distributions that may improve things.</p>
<p>So far we have been using normal distributions to do everything and the last DHARMa reading was very clearly pretty terrible.</p>
<p>As you can see, the distribution of <code>Vis</code> is skewed left, and both the <code>sqrt()</code> and the <code>log()</code> transformed versions look a lot better! We decided to try a model that tries transforming them like that.</p>
<p>We also tried a glm with a gamma distribution and a log link.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a>zscore_dat<span class="sc">$</span>Vis <span class="sc">%&gt;%</span> <span class="fu">hist</span>(<span class="at">main =</span> <span class="st">"no transformation on Vis"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Butterflies_V2_files/figure-html/vis%20hist-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a>zscore_dat<span class="sc">$</span>Vis <span class="sc">%&gt;%</span> sqrt <span class="sc">%&gt;%</span> <span class="fu">hist</span>(<span class="at">main =</span> <span class="st">"sqrt transformation on Vis"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Butterflies_V2_files/figure-html/vis%20hist-2.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>zscore_dat<span class="sc">$</span>Vis <span class="sc">%&gt;%</span> log <span class="sc">%&gt;%</span> <span class="fu">hist</span>(<span class="at">main =</span> <span class="st">"log transformation on Vis"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Butterflies_V2_files/figure-html/vis%20hist-3.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a>aic_mod_vis_log <span class="ot">=</span> zscore_dat <span class="sc">%&gt;%</span> </span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a>  lme4<span class="sc">::</span><span class="fu">lmer</span>(<span class="fu">log</span>(Vis) <span class="sc">~</span> BET<span class="sc">*</span>SolarRadi <span class="sc">+</span> BET<span class="sc">*</span>Isothermality <span class="sc">+</span> BET<span class="sc">*</span>temp.mean <span class="sc">+</span> (<span class="dv">1</span><span class="sc">|</span>genus) <span class="sc">+</span> (<span class="dv">1</span><span class="sc">|</span>dorvent) <span class="sc">-</span> <span class="dv">1</span>, </span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a>             <span class="at">data =</span> ., <span class="at">na.action =</span> <span class="st">"na.fail"</span>)</span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-5"><a href="#cb31-5" aria-hidden="true" tabindex="-1"></a>aic_mod_vis_sqrt <span class="ot">=</span> zscore_dat <span class="sc">%&gt;%</span> </span>
<span id="cb31-6"><a href="#cb31-6" aria-hidden="true" tabindex="-1"></a>  lme4<span class="sc">::</span><span class="fu">lmer</span>(<span class="fu">sqrt</span>(Vis) <span class="sc">~</span> BET<span class="sc">*</span>SolarRadi <span class="sc">+</span> BET<span class="sc">*</span>Isothermality <span class="sc">+</span> BET<span class="sc">*</span>temp.mean <span class="sc">+</span> (<span class="dv">1</span><span class="sc">|</span>genus) <span class="sc">+</span> (<span class="dv">1</span><span class="sc">|</span>dorvent) <span class="sc">-</span> <span class="dv">1</span>, </span>
<span id="cb31-7"><a href="#cb31-7" aria-hidden="true" tabindex="-1"></a>             <span class="at">data =</span> ., <span class="at">na.action =</span> <span class="st">"na.fail"</span>)</span>
<span id="cb31-8"><a href="#cb31-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-9"><a href="#cb31-9" aria-hidden="true" tabindex="-1"></a>aic_mod_vis_glm <span class="ot">=</span> zscore_dat <span class="sc">%&gt;%</span> </span>
<span id="cb31-10"><a href="#cb31-10" aria-hidden="true" tabindex="-1"></a>  lme4<span class="sc">::</span><span class="fu">glmer</span>((Vis) <span class="sc">~</span> BET<span class="sc">*</span>SolarRadi <span class="sc">+</span> BET<span class="sc">*</span>Isothermality <span class="sc">+</span> BET<span class="sc">*</span>temp.mean <span class="sc">+</span> (<span class="dv">1</span><span class="sc">|</span>genus) <span class="sc">+</span> (<span class="dv">1</span><span class="sc">|</span>dorvent) <span class="sc">-</span> <span class="dv">1</span>, </span>
<span id="cb31-11"><a href="#cb31-11" aria-hidden="true" tabindex="-1"></a>             <span class="at">data =</span> ., <span class="at">na.action =</span> <span class="st">"na.fail"</span>, <span class="at">family =</span> <span class="fu">Gamma</span>(<span class="at">link =</span> <span class="st">"log"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>To check the fit of the model, we’re looking at AIC scores again!</p>
<p>Then we can compare the model with the best AIC to the residual plots we observed originally to see if there’s any improvement!</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a>MuMIn<span class="sc">::</span><span class="fu">AICc</span>(aic_mod_vis, aic_mod_vis_log, aic_mod_vis_sqrt, aic_mod_vis_glm)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                 df      AICc
aic_mod_vis      15 14974.918
aic_mod_vis_log  15  1831.785
aic_mod_vis_sqrt 15  5245.277
aic_mod_vis_glm  15 14117.278</code></pre>
</div>
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a>DHARMa<span class="sc">::</span><span class="fu">simulateResiduals</span>(aic_mod_vis, <span class="at">n =</span> <span class="dv">1000</span>, <span class="at">plot =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Butterflies_V2_files/figure-html/vis%20residuals%20check-1.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Object of Class DHARMa with simulated residuals based on 1000 simulations with refit = FALSE . See ?DHARMa::simulateResiduals for help. 
 
Scaled residual values: 0.557 0.718 0.283 0.911 0.858 0.713 0.135 0.363 0.186 0.648 0.598 0.338 0.154 0.265 0.091 0.527 0.507 0.481 0.161 0.247 ...</code></pre>
</div>
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a>DHARMa<span class="sc">::</span><span class="fu">simulateResiduals</span>(aic_mod_vis_log, <span class="at">n =</span> <span class="dv">1000</span>, <span class="at">plot =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Butterflies_V2_files/figure-html/vis%20residuals%20check-2.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Object of Class DHARMa with simulated residuals based on 1000 simulations with refit = FALSE . See ?DHARMa::simulateResiduals for help. 
 
Scaled residual values: 0.659 0.684 0.355 0.898 0.792 0.814 0.07 0.451 0.215 0.712 0.618 0.453 0.111 0.344 0.028 0.624 0.575 0.605 0.04 0.301 ...</code></pre>
</div>
</div>
<p>It’s still not great, but it looks a lot better!</p>
</section>
<section id="infrared-reflectance-model" class="level2">
<h2 class="anchored" data-anchor-id="infrared-reflectance-model">Infrared reflectance model</h2>
<p>And now we repeat the process for the infrared data.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a>global_mod_nir <span class="ot">=</span> lme4<span class="sc">::</span><span class="fu">lmer</span>(Nir <span class="sc">~</span> BET<span class="sc">*</span>SolarRadi <span class="sc">+</span> BET<span class="sc">*</span>precip.mean <span class="sc">+</span> BET<span class="sc">*</span>WaterVapor <span class="sc">+</span> BET<span class="sc">*</span>Isothermality <span class="sc">+</span> BET<span class="sc">*</span>temp.mean <span class="sc">+</span> (<span class="dv">1</span><span class="sc">|</span>genus) <span class="sc">+</span> (<span class="dv">1</span><span class="sc">|</span>dorvent) <span class="sc">-</span> <span class="dv">1</span>, </span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a>             <span class="at">data =</span> zscore_dat, <span class="at">na.action =</span> <span class="st">"na.fail"</span>)</span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-4"><a href="#cb38-4" aria-hidden="true" tabindex="-1"></a>aic_score_nir <span class="ot">=</span> MuMIn<span class="sc">::</span><span class="fu">dredge</span>(global_mod_nir, <span class="at">beta =</span> <span class="st">"none"</span>)</span>
<span id="cb38-5"><a href="#cb38-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-6"><a href="#cb38-6" aria-hidden="true" tabindex="-1"></a>aic_score_nir <span class="sc">%&gt;%</span> <span class="fu">arrange</span>(AICc) <span class="sc">%&gt;%</span> <span class="fu">head</span>(<span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Global model call: lme4::lmer(formula = Nir ~ BET * SolarRadi + BET * precip.mean + 
    BET * WaterVapor + BET * Isothermality + BET * temp.mean + 
    (1 | genus) + (1 | dorvent) - 1, data = zscore_dat, na.action = "na.fail")
---
Model selection table 
  BET    Ist    SlR tmp.men     WtV BET:Ist BET:SlR BET:tmp.men BET:WtV df
1   + 1.0800 1.0720   1.064                       +           +         13
2   + 1.0780 0.9267   1.330 -0.1653               +           +       + 16
3   + 0.9559 1.1250   1.141               +       +           +         15
     logLik    AICc delta weight
1 -8049.494 16125.2  0.00  0.383
2 -8046.653 16125.6  0.40  0.313
3 -8047.693 16125.6  0.45  0.305
Models ranked by AICc(x) 
Random terms (all models): 
  1 | genus, 1 | dorvent</code></pre>
</div>
</div>
<p>Our most optimal model here is the inclusion of solar radiation, isothermality, and mean temperature, but with only solar radiation and mean temperature interacting with BET.</p>
<p>creating alternate methods!</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a>zscore_dat<span class="sc">$</span>Nir <span class="sc">%&gt;%</span> <span class="fu">hist</span>(<span class="at">main =</span> <span class="st">"no transformation on Nir"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Butterflies_V2_files/figure-html/nir%20hist-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a>zscore_dat<span class="sc">$</span>Nir <span class="sc">%&gt;%</span> sqrt <span class="sc">%&gt;%</span> <span class="fu">hist</span>(<span class="at">main =</span> <span class="st">"sqrt transformation on Nir"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Butterflies_V2_files/figure-html/nir%20hist-2.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a>zscore_dat<span class="sc">$</span>Nir <span class="sc">%&gt;%</span> log <span class="sc">%&gt;%</span> <span class="fu">hist</span>(<span class="at">main =</span> <span class="st">"log transformation on Nir"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Butterflies_V2_files/figure-html/nir%20hist-3.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a>aic_mod_nir <span class="ot">=</span> zscore_dat <span class="sc">%&gt;%</span> </span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a>  lme4<span class="sc">::</span><span class="fu">lmer</span>((Nir) <span class="sc">~</span> BET<span class="sc">*</span>SolarRadi <span class="sc">+</span> Isothermality <span class="sc">+</span> BET<span class="sc">*</span>temp.mean <span class="sc">+</span> (<span class="dv">1</span><span class="sc">|</span>genus) <span class="sc">+</span> (<span class="dv">1</span><span class="sc">|</span>dorvent) <span class="sc">-</span> <span class="dv">1</span>, </span>
<span id="cb43-3"><a href="#cb43-3" aria-hidden="true" tabindex="-1"></a>             <span class="at">data =</span> ., <span class="at">na.action =</span> <span class="st">"na.fail"</span>)</span>
<span id="cb43-4"><a href="#cb43-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-5"><a href="#cb43-5" aria-hidden="true" tabindex="-1"></a>aic_mod_nir_log <span class="ot">=</span> zscore_dat <span class="sc">%&gt;%</span> </span>
<span id="cb43-6"><a href="#cb43-6" aria-hidden="true" tabindex="-1"></a>  lme4<span class="sc">::</span><span class="fu">lmer</span>(<span class="fu">log</span>(Nir) <span class="sc">~</span> BET<span class="sc">*</span>SolarRadi <span class="sc">+</span> Isothermality <span class="sc">+</span> BET<span class="sc">*</span>temp.mean <span class="sc">+</span> (<span class="dv">1</span><span class="sc">|</span>genus) <span class="sc">+</span> (<span class="dv">1</span><span class="sc">|</span>dorvent) <span class="sc">-</span> <span class="dv">1</span>, </span>
<span id="cb43-7"><a href="#cb43-7" aria-hidden="true" tabindex="-1"></a>             <span class="at">data =</span> ., <span class="at">na.action =</span> <span class="st">"na.fail"</span>)</span>
<span id="cb43-8"><a href="#cb43-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-9"><a href="#cb43-9" aria-hidden="true" tabindex="-1"></a>aic_mod_nir_sqrt <span class="ot">=</span> zscore_dat <span class="sc">%&gt;%</span> </span>
<span id="cb43-10"><a href="#cb43-10" aria-hidden="true" tabindex="-1"></a>  lme4<span class="sc">::</span><span class="fu">lmer</span>(<span class="fu">sqrt</span>(Nir) <span class="sc">~</span> BET<span class="sc">*</span>SolarRadi <span class="sc">+</span> Isothermality <span class="sc">+</span> BET<span class="sc">*</span>temp.mean <span class="sc">+</span> (<span class="dv">1</span><span class="sc">|</span>genus) <span class="sc">+</span> (<span class="dv">1</span><span class="sc">|</span>dorvent) <span class="sc">-</span> <span class="dv">1</span>, </span>
<span id="cb43-11"><a href="#cb43-11" aria-hidden="true" tabindex="-1"></a>             <span class="at">data =</span> ., <span class="at">na.action =</span> <span class="st">"na.fail"</span>)</span>
<span id="cb43-12"><a href="#cb43-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-13"><a href="#cb43-13" aria-hidden="true" tabindex="-1"></a>aic_mod_nir_glm <span class="ot">=</span> zscore_dat <span class="sc">%&gt;%</span> </span>
<span id="cb43-14"><a href="#cb43-14" aria-hidden="true" tabindex="-1"></a>  lme4<span class="sc">::</span><span class="fu">glmer</span>((Nir) <span class="sc">~</span> BET<span class="sc">*</span>SolarRadi <span class="sc">+</span> BET<span class="sc">*</span>Isothermality <span class="sc">+</span> BET<span class="sc">*</span>temp.mean <span class="sc">+</span> (<span class="dv">1</span><span class="sc">|</span>genus) <span class="sc">+</span> (<span class="dv">1</span><span class="sc">|</span>dorvent) <span class="sc">-</span> <span class="dv">1</span>, </span>
<span id="cb43-15"><a href="#cb43-15" aria-hidden="true" tabindex="-1"></a>             <span class="at">data =</span> ., <span class="at">na.action =</span> <span class="st">"na.fail"</span>, <span class="at">family =</span> <span class="fu">Gamma</span>(<span class="at">link =</span> <span class="st">"log"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Here it looks like the log transformed data is more skewed than either alternative, but the model still fit the best according to the AIC!</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a>MuMIn<span class="sc">::</span><span class="fu">AICc</span>(aic_mod_nir, aic_mod_nir_log, aic_mod_nir_sqrt, aic_mod_vis_glm)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                 df       AICc
aic_mod_nir      13 16125.1671
aic_mod_nir_log  13   180.8929
aic_mod_nir_sqrt 13  5181.4956
aic_mod_vis_glm  15 14117.2780</code></pre>
</div>
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a>DHARMa<span class="sc">::</span><span class="fu">simulateResiduals</span>(aic_mod_nir, <span class="at">n =</span> <span class="dv">1000</span>, <span class="at">plot =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Butterflies_V2_files/figure-html/nir%20residuals%20check-1.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Object of Class DHARMa with simulated residuals based on 1000 simulations with refit = FALSE . See ?DHARMa::simulateResiduals for help. 
 
Scaled residual values: 0.443 0.49 0.234 0.951 0.68 0.76 0.05 0.261 0.133 0.698 0.458 0.306 0.091 0.214 0.045 0.61 0.472 0.515 0.071 0.116 ...</code></pre>
</div>
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a>DHARMa<span class="sc">::</span><span class="fu">simulateResiduals</span>(aic_mod_nir_log, <span class="at">n =</span> <span class="dv">1000</span>, <span class="at">plot =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Butterflies_V2_files/figure-html/nir%20residuals%20check-2.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Object of Class DHARMa with simulated residuals based on 1000 simulations with refit = FALSE . See ?DHARMa::simulateResiduals for help. 
 
Scaled residual values: 0.516 0.5 0.286 0.921 0.642 0.81 0.026 0.319 0.164 0.723 0.476 0.383 0.073 0.29 0.012 0.658 0.502 0.588 0.014 0.168 ...</code></pre>
</div>
</div>
</section>
<section id="final-results-plots" class="level2">
<h2 class="anchored" data-anchor-id="final-results-plots">Final Results + plots!</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a>aic_mod_vis_log <span class="sc">%&gt;%</span> car<span class="sc">::</span><span class="fu">Anova</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Analysis of Deviance Table (Type II Wald chisquare tests)

Response: log(Vis)
                     Chisq Df Pr(&gt;Chisq)    
BET               945.1241  3  &lt; 2.2e-16 ***
SolarRadi           9.8563  1  0.0016925 ** 
Isothermality       7.6337  1  0.0057287 ** 
temp.mean           0.7395  1  0.3898347    
BET:SolarRadi       2.2837  2  0.3192341    
BET:Isothermality   3.2585  2  0.1960805    
BET:temp.mean      18.1870  2  0.0001124 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a>aic_mod_vis_log <span class="sc">%&gt;%</span> summary <span class="sc">%&gt;%</span> <span class="fu">coefficients</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                       Estimate Std. Error    t value
BETB                2.918573417 0.34970160  8.3458967
BETE                3.371485524 0.34970160  9.6410355
BETT                2.895664584 0.34970160  8.2803871
SolarRadi           0.032951955 0.03264740  1.0093287
Isothermality       0.011616137 0.01194089  0.9728031
temp.mean           0.055901401 0.02519080  2.2191197
BETE:SolarRadi      0.054359340 0.04166250  1.3047545
BETT:SolarRadi      0.054688207 0.04166250  1.3126481
BETE:Isothermality  0.026154872 0.01555094  1.6818839
BETT:Isothermality  0.004249008 0.01555094  0.2732316
BETE:temp.mean     -0.119694587 0.03191922 -3.7499225
BETT:temp.mean     -0.003703605 0.03191922 -0.1160306</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a>aic_mod_nir_log <span class="sc">%&gt;%</span> car<span class="sc">::</span><span class="fu">Anova</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Analysis of Deviance Table (Type II Wald chisquare tests)

Response: log(Nir)
                  Chisq Df Pr(&gt;Chisq)    
BET           2008.8317  3  &lt; 2.2e-16 ***
SolarRadi       11.8115  1  0.0005887 ***
Isothermality   14.9556  1  0.0001101 ***
temp.mean        0.1745  1  0.6761030    
BET:SolarRadi    2.3836  2  0.3036730    
BET:temp.mean   13.8369  2  0.0009894 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a>aic_mod_nir_log <span class="sc">%&gt;%</span> summary <span class="sc">%&gt;%</span> <span class="fu">coefficients</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                  Estimate  Std. Error    t value
BETB            3.89856913 0.232621748 16.7592633
BETE            4.32843717 0.232621748 18.6071904
BETT            3.84893675 0.232621748 16.5459024
SolarRadi       0.02631093 0.021960041  1.1981277
Isothermality   0.02028873 0.005246299  3.8672457
temp.mean       0.01276104 0.016637189  0.7670193
BETE:SolarRadi  0.03282789 0.028083176  1.1689522
BETT:SolarRadi  0.04094246 0.028083176  1.4578998
BETE:temp.mean -0.06187418 0.020770981 -2.9788760
BETT:temp.mean  0.00913741 0.020770981  0.4399123</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a>longdat[,<span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>, <span class="dv">8</span>, <span class="dv">14</span><span class="sc">:</span><span class="dv">16</span>)] <span class="sc">%&gt;%</span> </span>
<span id="cb58-2"><a href="#cb58-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> temp.mean, <span class="at">y =</span> Vis)) <span class="sc">+</span> </span>
<span id="cb58-3"><a href="#cb58-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">color =</span> BET)) <span class="sc">+</span> </span>
<span id="cb58-4"><a href="#cb58-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="fu">aes</span>(<span class="at">color =</span> BET)) <span class="sc">+</span> </span>
<span id="cb58-5"><a href="#cb58-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">color =</span> <span class="st">"red"</span>) <span class="sc">+</span> </span>
<span id="cb58-6"><a href="#cb58-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Mean temp"</span>, <span class="at">y =</span> <span class="st">"UV / Visual reflectance"</span>, <span class="at">color =</span> <span class="st">"Location"</span>) <span class="sc">+</span></span>
<span id="cb58-7"><a href="#cb58-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_viridis_d</span>(<span class="at">begin =</span> <span class="fl">0.1</span>, <span class="at">end =</span> <span class="fl">0.7</span>) <span class="sc">+</span> </span>
<span id="cb58-8"><a href="#cb58-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>() <span class="sc">+</span> </span>
<span id="cb58-9"><a href="#cb58-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>)) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using formula = 'y ~ x'
`geom_smooth()` using formula = 'y ~ x'</code></pre>
</div>
<div class="cell-output-display">
<p><img src="Butterflies_V2_files/figure-html/some%20plots-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a>longdat[,<span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>, <span class="dv">8</span>, <span class="dv">14</span><span class="sc">:</span><span class="dv">16</span>)] <span class="sc">%&gt;%</span> </span>
<span id="cb60-2"><a href="#cb60-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> temp.mean, <span class="at">y =</span> Nir)) <span class="sc">+</span> </span>
<span id="cb60-3"><a href="#cb60-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">color =</span> BET)) <span class="sc">+</span> </span>
<span id="cb60-4"><a href="#cb60-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="fu">aes</span>(<span class="at">color =</span> BET)) <span class="sc">+</span> </span>
<span id="cb60-5"><a href="#cb60-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">color =</span> <span class="st">"red"</span>) <span class="sc">+</span> </span>
<span id="cb60-6"><a href="#cb60-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Mean temp"</span>, <span class="at">y =</span> <span class="st">"Infrared reflectance"</span>, <span class="at">color =</span> <span class="st">"Location"</span>) <span class="sc">+</span></span>
<span id="cb60-7"><a href="#cb60-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_viridis_d</span>(<span class="at">begin =</span> <span class="fl">0.1</span>, <span class="at">end =</span> <span class="fl">0.7</span>) <span class="sc">+</span> </span>
<span id="cb60-8"><a href="#cb60-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>() <span class="sc">+</span> </span>
<span id="cb60-9"><a href="#cb60-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>)) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using formula = 'y ~ x'
`geom_smooth()` using formula = 'y ~ x'</code></pre>
</div>
<div class="cell-output-display">
<p><img src="Butterflies_V2_files/figure-html/some%20plots-2.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb62"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a>longdat[,<span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>, <span class="dv">8</span>, <span class="dv">14</span><span class="sc">:</span><span class="dv">16</span>)] <span class="sc">%&gt;%</span> </span>
<span id="cb62-2"><a href="#cb62-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> Isothermality, <span class="at">y =</span> Vis)) <span class="sc">+</span> </span>
<span id="cb62-3"><a href="#cb62-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span> </span>
<span id="cb62-4"><a href="#cb62-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>) <span class="sc">+</span> </span>
<span id="cb62-5"><a href="#cb62-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>() <span class="sc">+</span></span>
<span id="cb62-6"><a href="#cb62-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y =</span> <span class="st">"UV / Visual reflectance"</span>) <span class="sc">+</span></span>
<span id="cb62-7"><a href="#cb62-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>() <span class="sc">+</span> </span>
<span id="cb62-8"><a href="#cb62-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>)) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using formula = 'y ~ x'</code></pre>
</div>
<div class="cell-output-display">
<p><img src="Butterflies_V2_files/figure-html/some%20plots-3.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb64"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a>longdat[,<span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>, <span class="dv">8</span>, <span class="dv">14</span><span class="sc">:</span><span class="dv">16</span>)] <span class="sc">%&gt;%</span> </span>
<span id="cb64-2"><a href="#cb64-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> Isothermality, <span class="at">y =</span> Nir)) <span class="sc">+</span> </span>
<span id="cb64-3"><a href="#cb64-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span> </span>
<span id="cb64-4"><a href="#cb64-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>) <span class="sc">+</span> </span>
<span id="cb64-5"><a href="#cb64-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>() <span class="sc">+</span></span>
<span id="cb64-6"><a href="#cb64-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y =</span> <span class="st">"Infrared reflectance"</span>) <span class="sc">+</span></span>
<span id="cb64-7"><a href="#cb64-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>() <span class="sc">+</span> </span>
<span id="cb64-8"><a href="#cb64-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>)) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using formula = 'y ~ x'</code></pre>
</div>
<div class="cell-output-display">
<p><img src="Butterflies_V2_files/figure-html/some%20plots-4.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>So what does this tell us?</p>
<p>Essentially temperature mean both has a significant interaction with the different parts of the butterfly’s body that affects the infrared reflectance. This interaction also exists when considering the UV radiation reflectance. In both cases, solar radiation and isothermality affected the different light reflectances significantly, just not differently between the different body parts. From both the plots and the coefficients, you can clearly see that the thorax is affected by temperature mean more than any of the other parts of the butterfly. This could indicate that this part of the butterfly is much more important for the ultimate heat regulation than the entire wing area, or even the basal wing area.</p>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>